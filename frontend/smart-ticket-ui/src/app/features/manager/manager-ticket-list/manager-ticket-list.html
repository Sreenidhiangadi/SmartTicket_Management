<div class="container-fluid px-4">

  <h3 class="fw-bold mb-3">All Tickets</h3>

  <!-- FILTERS -->
  <div class="card mb-3 shadow-sm">
    <div class="card-body d-flex flex-wrap gap-3 align-items-end">

      <div>
        <label class="form-label">Status</label>
        <select class="form-select" [(ngModel)]="status">
          <option value="">All</option>
          <option *ngFor="let s of statuses" [value]="s">
            {{ s }}
          </option>
        </select>
      </div>

      <div>
        <label class="form-label">Priority</label>
        <select class="form-select" [(ngModel)]="priority">
          <option value="">All</option>
          <option *ngFor="let p of priorities" [value]="p">
            {{ p }}
          </option>
        </select>
      </div>

      <div class="d-flex gap-2">
        <button class="btn btn-primary" (click)="applyFilters()">
          Apply
        </button>
        <button class="btn btn-outline-secondary" (click)="resetFilters()">
          Reset
        </button>
      </div>

    </div>
  </div>

  <!-- LOADING -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary"></div>
  </div>

  <!-- ERROR -->
  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <!-- TABLE -->
  <div class="card shadow-sm" *ngIf="!loading">
    <div class="table-responsive">
      <table class="table table-hover mb-0 align-middle">
        <thead class="table-light">
          <tr>
            <th>Title</th>
            <th>Priority</th>
            <th>Status</th>
            <th>Created</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let t of tickets">
            <td>
              <a [routerLink]="['/tickets', t.id]">
                {{ t.title }}
              </a>
            </td>
            <td>
              <span class="badge bg-info">{{ t.priority }}</span>
            </td>
            <td>
              <span class="badge bg-secondary">{{ t.status }}</span>
            </td>
            <td>
              {{ t.createdAt | date:'short' }}
            </td>
          </tr>

          <tr *ngIf="tickets.length === 0">
            <td colspan="4" class="text-center text-muted py-4">
              No tickets found
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- PAGINATION -->
  <div class="d-flex justify-content-between align-items-center mt-3">
    <button
      class="btn btn-outline-secondary"
      (click)="prevPage()"
      [disabled]="page === 0"
    >
      Previous
    </button>

    <span class="text-muted">
      Page {{ page + 1 }}
    </span>

    <button
      class="btn btn-outline-secondary"
      (click)="nextPage()"
      [disabled]="tickets.length < size"
    >
      Next
    </button>
  </div>

</div>
