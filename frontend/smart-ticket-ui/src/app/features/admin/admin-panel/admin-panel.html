<div class="container-fluid px-4 admin-page">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold mb-0">Admin Panel</h3>
    <!-- <span class="badge bg-dark">User Management</span> -->
  </div>

  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary"></div>
    <p class="mt-2 text-muted">Loading users...</p>
  </div>

  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <div class="card shadow-sm" *ngIf="!loading">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Roles</th>
            <th>Status</th>
            <th style="width: 220px">Actions</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let user of users">
            <td class="fw-semibold">{{ user.name }}</td>
            <td class="text-muted">{{ user.email }}</td>

            <td>
              <span
                class="badge me-1"
                *ngFor="let r of user.roles"
                [class.bg-primary]="r === 'USER'"
                [class.bg-warning]="r === 'AGENT'"
                [class.bg-info]="r === 'MANAGER'"
                [class.bg-danger]="r === 'ADMIN'"
              >
                {{ r }}
              </span>
            </td>

            <td>
              <span
                class="badge"
                [class.bg-success]="user.active"
                [class.bg-secondary]="!user.active"
              >
                {{ user.active ? 'Active' : 'Inactive' }}
              </span>
            </td>

            <td class="d-flex gap-2">
              <button
                class="btn btn-sm"
                [class.btn-outline-danger]="user.active"
                [class.btn-outline-success]="!user.active"
                (click)="toggleActive(user)"
              >
                {{ user.active ? 'Deactivate' : 'Activate' }}
              </button>

              <select
  class="form-select form-select-sm"
  [disabled]="isSelf(user)"
  (change)="updateRole(user, $any($event.target).value)"
>

                <option disabled selected>Change Role</option>
                <option value="USER">USER</option>
                <option value="AGENT">AGENT</option>
                <option value="MANAGER">MANAGER</option>
                <option value="ADMIN">ADMIN</option>
              </select>
            </td>
          </tr>

          <tr *ngIf="users.length === 0">
            <td colspan="5" class="text-center py-4 text-muted">
              No users found
            </td>
          </tr>

        </tbody>
      </table>
    </div>
  </div>

</div>
