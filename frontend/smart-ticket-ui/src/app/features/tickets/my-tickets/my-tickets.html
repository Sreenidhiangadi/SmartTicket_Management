<div class="container-fluid px-4 my-tickets">
  <div class="content-shell">

    <h3 class="fw-bold mb-4">My Tickets</h3>

    <!-- FILTERS -->
    <div class="filters-bar mb-3">
      <div class="row g-2 align-items-end">

        <div class="col-sm-4 col-md-3">
          <label class="form-label">Status</label>
          <select
            class="form-select"
            [(ngModel)]="statusFilter"
          >
            <option value="">All</option>
            <option value="CREATED">Created</option>
            <option value="ASSIGNED">Assigned</option>
            <option value="IN_PROGRESS">In Progress</option>
            <option value="RESOLVED">Resolved</option>
            <option value="CLOSED">Closed</option>
          </select>
        </div>

        <div class="col-sm-4 col-md-3">
          <label class="form-label">Priority</label>
          <select
            class="form-select"
            [(ngModel)]="priorityFilter"
          >
            <option value="">All</option>
            <option value="LOW">Low</option>
            <option value="MEDIUM">Medium</option>
            <option value="HIGH">High</option>
            <option value="CRITICAL">Critical</option>
          </select>
        </div>

        <div class="col-sm-4 col-md-2">
          <button
            class="btn btn-primary w-100"
            (click)="applyFilters()"
          >
            Apply
          </button>
        </div>

        <div class="col-sm-4 col-md-2">
          <button
            class="btn btn-outline-secondary w-100"
            (click)="clearFilters()"
          >
            Clear
          </button>
        </div>

      </div>
    </div>

    <!-- LOADING -->
    <div *ngIf="loading" class="state-container">
      <div class="spinner-border text-primary"></div>
      <p class="text-muted mt-3">Loading tickets…</p>
    </div>

    <!-- ERROR -->
    <div *ngIf="error" class="alert alert-danger">
      {{ error }}
    </div>

    <!-- EMPTY (NO TICKETS AT ALL) -->
    <div
      *ngIf="!loading && tickets.length === 0"
      class="state-container"
    >
      <i class="bi bi-inbox empty-icon"></i>
      <p class="text-muted mt-3 mb-0">
        You haven’t raised any tickets yet
      </p>
    </div>

    <!-- TABLE -->
    <div
      class="table-responsive"
      *ngIf="!loading && filteredTickets.length"
    >
      <table class="table ticket-table align-middle">
        <thead>
          <tr>
            <th>Title</th>
            <th>Status</th>
            <th>Priority</th>
            <th>Created</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let t of filteredTickets">
            <td>
              <a
                [routerLink]="['/tickets', t.id]"
                class="ticket-link"
              >
                {{ t.title }}
              </a>
              <div class="text-muted small">
                {{ t.description }}
              </div>
            </td>

            <td>
              <span
                class="status-pill"
                [ngClass]="t.status.toLowerCase()"
              >
                {{ t.status }}
              </span>
            </td>

            <td>
              <span class="priority-pill">
                {{ t.priority }}
              </span>
            </td>

            <td class="text-muted small">
              {{ t.createdAt | date:'short' }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- EMPTY (FILTERS APPLIED BUT NO MATCH) -->
    <div
      *ngIf="!loading && tickets.length && filteredTickets.length === 0"
      class="state-container"
    >
      <p class="text-muted mb-0">
        No tickets match the selected filters
      </p>
    </div>

  </div>
</div>
